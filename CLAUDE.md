# CLAUDE.md

> Project context for Claude sessions. Generated by `prime`.

## Quick Context

MOC (Microsoft On-premises Cloud) is a Go library providing Protocol Buffer definitions and shared utilities for Microsoft's on-premises cloud infrastructure. It defines gRPC service contracts for multiple agents (cloud, node, guest, load balancer, etc.) and includes utility packages for authentication, error handling, and more.

## Context Docs

- [Architecture](.claude/context/architecture.md) - System overview, components, data flow
- [Patterns](.claude/context/patterns.md) - Design patterns, naming conventions, error handling
- [Structure](.claude/context/structure.md) - Directory layout, key files, module relationships
- [Usage](.claude/context/usage.md) - Installation, commands, development workflow
- [Tests](.claude/context/tests.md) - Test framework, running tests, writing tests

## Key Commands

```bash
make generate    # Regenerate .pb.go files from .proto definitions
make all         # Format + run tests
make test        # Run unit tests (go test -v ./pkg/...)
make mocks       # Generate mock files with mockgen
make format      # Run gofmt on rpc/ and pkg/
make golangci-lint  # Run linter
```

## Notes

- **Proto Generation**: Requires Linux for `protoc` (uses `protoc-linux-x86_64`)
- **Module Path**: `github.com/microsoft/moc`
- **Go Version**: 1.24+ (see `go.mod`)
- **82 proto files** across multiple agents in `rpc/`
- Generated code (`.pb.go`) is committed to the repository
- Uses `[(sensitive) = true]` proto option for fields needing redaction
